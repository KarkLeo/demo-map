(this["webpackJsonpmapbox-test"]=this["webpackJsonpmapbox-test"]||[]).push([[0],{133:function(t,e,n){},134:function(t,e,n){},135:function(t,e,n){},138:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),c=n(40),i=n.n(c),a=(n(90),n(91),n(23)),u=n(15);const s=({feature:t,state:e})=>{switch(e){case u.RENDER_STATE.SELECTED:case u.RENDER_STATE.HOVERED:case u.RENDER_STATE.UNCOMMITTED:return{fill:"rgb(251, 176, 59)",fillOpacity:1,stroke:"rgb(255, 255, 255)",strokeWidth:2,r:7};default:return{fill:"rgb(251, 176, 59)",fillOpacity:1,stroke:"rgb(255, 255, 255)",strokeWidth:2,r:5}}},d=({feature:t,index:e,state:n})=>{switch(n){case u.RENDER_STATE.SELECTED:case u.RENDER_STATE.HOVERED:case u.RENDER_STATE.UNCOMMITTED:case u.RENDER_STATE.CLOSING:return{stroke:"rgb(251, 176, 59)",strokeWidth:2,fill:"rgb(251, 176, 59)",fillOpacity:.3,strokeDasharray:"4,2"};default:return{stroke:"rgb(60, 178, 208)",strokeWidth:2,fill:"rgb(60, 178, 208)",fillOpacity:.1}}};var l=n(5);const b={position:"fixed",zIndex:999,top:"30px",right:"20px",display:"flex",flexDirection:"column",gap:"10px"};var f=()=>{const[t,e]=Object(r.useState)(new u.EditingMode);console.log(t&&t.constructor.name);const[n,o]=Object(r.useState)(null),c=Object(r.useRef)(null),i=Object(r.useCallback)((t=>{o(t&&t.selectedFeatureIndex)}),[]),a=Object(r.useCallback)((({editType:t})=>{"addFeature"===t&&e(new u.EditingMode)}),[]),f=Object(r.useCallback)((()=>{null!==n&&n>=0&&c.current&&c.current.deleteFeatures(n)}),[n]);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(u.Editor,{ref:c,style:{width:"100%",height:"100%"},clickRadius:12,mode:t,onSelect:i,onUpdate:a,editHandleShape:"circle",featureStyle:d,editHandleStyle:s,featuresDraggable:!0}),Object(l.jsxs)("div",{style:b,children:[t&&"DrawPolygonMode"!==t.constructor.name&&Object(l.jsx)("button",{onClick:()=>e(new u.DrawPolygonMode),children:"New poly"}),t&&"DrawPolygonMode"!==t.constructor.name&&null!==n&&Object(l.jsx)("button",{onClick:f,children:"Delete"})]})]})},j=n(13),O=n(16);var p=()=>{const t=Object(j.c)(O.getUserPathSourceSelector);return Object(l.jsx)(a.Source,{id:"my-data",type:"geojson",data:t,children:Object(l.jsx)(a.Layer,{id:"user-path-layer",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#01579b","line-width":6}})})};var h=t=>{const e=Object(j.b)();Object(r.useEffect)((()=>{(async()=>{await(async t=>{await navigator.geolocation.watchPosition((e=>{t(e)}),(t=>console.log(t)),{enableHighAccuracy:!0,maximumAge:5e3})})((n=>{n&&(e(Object(O.pushPositionAction)(n)),t&&t(n))}))})()}),[e,t])};n(133);var E=({viewport:{longitude:t,latitude:e,zoom:n}})=>Object(l.jsxs)("div",{className:"viewport-info",children:[Object(l.jsxs)("span",{className:"viewport-info__item",children:["longitude: ",t.toFixed(4)]}),Object(l.jsxs)("span",{className:"viewport-info__item",children:["latitude: ",e.toFixed(4)]}),Object(l.jsxs)("span",{className:"viewport-info__item",children:["zoom: ",n.toFixed(4)]})]}),g=n(19),m=n(48),v=n.n(m);n(134);var S=()=>{const t=Object(j.b)(),e=Object(j.c)(g.getModeSelector),n=Object(r.useCallback)((()=>t(Object(g.turnOnNavigateAction)())),[t]),o=Object(r.useCallback)((()=>t(Object(g.turnOnEditAction)())),[t]),c=Object(r.useCallback)((()=>t(Object(g.turnOnFreeAction)())),[t]);return Object(l.jsxs)("div",{className:"mode-bar",children:[Object(l.jsx)("button",{onClick:c,className:v()("mode-bar__button",{"mode-bar__button--active":"FREE"===e}),disabled:"FREE"===e,children:"Free mode"}),Object(l.jsx)("button",{onClick:n,className:v()("mode-bar__button",{"mode-bar__button--active":"NAVIGATE"===e}),disabled:"NAVIGATE"===e,children:"Navigate mode"}),Object(l.jsx)("button",{onClick:o,className:v()("mode-bar__button",{"mode-bar__button--active":"EDIT"===e}),disabled:"EDIT"===e,children:"Edit mode"})]})};n(135);var x=()=>{const t=Object(j.c)(O.getUserPositionSelector);return t&&Object(l.jsx)(a.Marker,{longitude:t.coords.longitude,latitude:t.coords.latitude,children:Object(l.jsx)("div",{className:"point"})})};var A=()=>{const[t,e]=Object(r.useState)({longitude:-91.874,latitude:42.76,zoom:12}),n=Object(j.c)(g.getModeSelector),o=Object(j.c)(O.getUserPositionSelector);return Object(r.useEffect)((()=>{switch(n){case"FREE":return;case"NAVIGATE":return void(o&&e({longitude:o.coords.longitude,latitude:o.coords.latitude,zoom:16}))}}),[n,o,e]),h(),Object(l.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[Object(l.jsxs)(a.default,{...t,width:"100%",height:"100%",mapStyle:"mapbox://styles/kark-leo/ckrq5pa1k7b9j17qr2tvv7ixy",onViewportChange:e,mapboxApiAccessToken:"pk.eyJ1Ijoia2Fyay1sZW8iLCJhIjoiY2tycTVqeDF5MDRmaDJucHF6bjl0aWRlMSJ9.fVvoRu7-JIUyyIkbFQ9vQA",children:["NAVIGATE"!==n&&Object(l.jsx)(a.NavigationControl,{}),"EDIT"===n&&Object(l.jsx)(f,{}),Object(l.jsx)(p,{}),Object(l.jsx)(x,{})]}),Object(l.jsx)(E,{viewport:t}),Object(l.jsx)(S,{})]})};var y=function(){return Object(l.jsx)("div",{className:"App",children:Object(l.jsx)(A,{})})};var R=t=>{t&&t instanceof Function&&n.e(3).then(n.bind(null,140)).then((({getCLS:e,getFID:n,getFCP:r,getLCP:o,getTTFB:c})=>{e(t),n(t),r(t),o(t),c(t)}))},T=(n(136),n(44));i.a.render(Object(l.jsx)(o.a.StrictMode,{children:Object(l.jsx)(j.a,{store:T.appStore,children:Object(l.jsx)(y,{})})}),document.getElementById("root")),R()},16:function(t,e,n){"use strict";var r=n(70);n.o(r,"getUserPathSourceSelector")&&n.d(e,"getUserPathSourceSelector",(function(){return r.getUserPathSourceSelector})),n.o(r,"getUserPositionSelector")&&n.d(e,"getUserPositionSelector",(function(){return r.getUserPositionSelector})),n.o(r,"initialState")&&n.d(e,"initialState",(function(){return r.initialState})),n.o(r,"pushPositionAction")&&n.d(e,"pushPositionAction",(function(){return r.pushPositionAction})),n.o(r,"userPathReducer")&&n.d(e,"userPathReducer",(function(){return r.userPathReducer}));var o=n(71);n.d(e,"initialState",(function(){return o.a}));var c=n(41);n.d(e,"userPathReducer",(function(){return c.b}));var i=n(72);n.d(e,"pushPositionAction",(function(){return i.a}));var a=n(73);n.d(e,"getUserPathSourceSelector",(function(){return a.a})),n.d(e,"getUserPositionSelector",(function(){return a.b}))},19:function(t,e,n){"use strict";var r=n(74);n.o(r,"getModeSelector")&&n.d(e,"getModeSelector",(function(){return r.getModeSelector})),n.o(r,"initialState")&&n.d(e,"initialState",(function(){return r.initialState})),n.o(r,"modeReducer")&&n.d(e,"modeReducer",(function(){return r.modeReducer})),n.o(r,"turnOnEditAction")&&n.d(e,"turnOnEditAction",(function(){return r.turnOnEditAction})),n.o(r,"turnOnFreeAction")&&n.d(e,"turnOnFreeAction",(function(){return r.turnOnFreeAction})),n.o(r,"turnOnNavigateAction")&&n.d(e,"turnOnNavigateAction",(function(){return r.turnOnNavigateAction}));var o=n(75);n.d(e,"initialState",(function(){return o.a}));var c=n(32);n.d(e,"modeReducer",(function(){return c.d}));var i=n(76);n.d(e,"turnOnEditAction",(function(){return i.a})),n.d(e,"turnOnFreeAction",(function(){return i.b})),n.d(e,"turnOnNavigateAction",(function(){return i.c}));var a=n(77);n.d(e,"getModeSelector",(function(){return a.a}))},32:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return a}));var r=n(19);const o="MODE/TURN_ON_NAVIGATE",c="MODE/TURN_ON_EDIT",i="MODE/TURN_ON_FREE",a=(t=r.initialState,e)=>{switch(e.type){case o:return{...t,mode:"NAVIGATE"};case c:return{...t,mode:"EDIT"};case i:return{...t,mode:"FREE"};default:return t}}},41:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(16);const o="USER_PATH/PUSH__POSITION",c=(t=r.initialState,e)=>{switch(e.type){case o:return{...t,path:[...t.path,e.position],position:e.position};default:return t}}},44:function(t,e,n){"use strict";var r=n(78);n.d(e,"appReducer",(function(){return r.a}));var o=n(79);n.d(e,"appStore",(function(){return o.a}));n(80)},70:function(t,e){},71:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={path:[],position:null}},72:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(41);const o=t=>({type:r.a,position:t})},73:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c}));var r=n(84);const o=t=>t.userPath.position,c=Object(r.a)((t=>t.userPath.path),(t=>({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t.map((t=>[t.coords.longitude,t.coords.latitude]))}})))},74:function(t,e){},75:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={mode:"FREE"}},76:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return i}));var r=n(32);const o=()=>({type:r.a}),c=()=>({type:r.c}),i=()=>({type:r.b})},77:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>t.mode.mode},78:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(34),o=n(16),c=n(19);const i=Object(r.combineReducers)({userPath:o.userPathReducer,mode:c.modeReducer})},79:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(34),o=n(85),c=n(44);const i=Object(r.createStore)(c.appReducer,Object(o.composeWithDevTools)())},80:function(t,e){},90:function(t,e,n){},91:function(t,e,n){}},[[138,1,2]]]);
//# sourceMappingURL=main.0f7cb590.chunk.js.map