(this["webpackJsonpmapbox-test"]=this["webpackJsonpmapbox-test"]||[]).push([[0],{14:function(t,e,n){"use strict";var r=n(77);n.o(r,"getUserPathSourceSelector")&&n.d(e,"getUserPathSourceSelector",(function(){return r.getUserPathSourceSelector})),n.o(r,"getUserPositionSelector")&&n.d(e,"getUserPositionSelector",(function(){return r.getUserPositionSelector})),n.o(r,"initialState")&&n.d(e,"initialState",(function(){return r.initialState})),n.o(r,"pushPositionAction")&&n.d(e,"pushPositionAction",(function(){return r.pushPositionAction})),n.o(r,"userPathReducer")&&n.d(e,"userPathReducer",(function(){return r.userPathReducer}));var c=n(78);n.d(e,"initialState",(function(){return c.a}));var o=n(43);n.d(e,"userPathReducer",(function(){return o.b}));var i=n(79);n.d(e,"pushPositionAction",(function(){return i.a}));var a=n(80);n.d(e,"getUserPathSourceSelector",(function(){return a.a})),n.d(e,"getUserPositionSelector",(function(){return a.b}))},140:function(t,e,n){},141:function(t,e,n){},142:function(t,e,n){},145:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n.n(r),o=n(41),i=n.n(o),a=(n(97),n(98),n(16)),u=n(17);const s=({feature:t,state:e})=>{switch(e){case u.RENDER_STATE.SELECTED:case u.RENDER_STATE.HOVERED:case u.RENDER_STATE.UNCOMMITTED:return{fill:"rgb(251, 176, 59)",fillOpacity:1,stroke:"rgb(255, 255, 255)",strokeWidth:2,r:7};default:return{fill:"rgb(251, 176, 59)",fillOpacity:1,stroke:"rgb(255, 255, 255)",strokeWidth:2,r:5}}},d=({feature:t,index:e,state:n})=>{switch(n){case u.RENDER_STATE.SELECTED:case u.RENDER_STATE.HOVERED:case u.RENDER_STATE.UNCOMMITTED:case u.RENDER_STATE.CLOSING:return{stroke:"rgb(251, 176, 59)",strokeWidth:2,fill:"rgb(251, 176, 59)",fillOpacity:.3,strokeDasharray:"4,2"};default:return{stroke:"rgb(60, 178, 208)",strokeWidth:2,fill:"rgb(60, 178, 208)",fillOpacity:.1}}};var l=n(7),b=n(18),f=n(5);const j={position:"fixed",zIndex:999,top:"40px",right:"20px",display:"flex",flexDirection:"column",gap:"10px"};var O=()=>{const t=Object(l.b)(),[e,n]=Object(r.useState)(new u.EditingMode),[c,o]=Object(r.useState)(null),i=Object(r.useRef)(null),a=Object(l.c)(b.getAreasSelector);Object(r.useEffect)((()=>{i.current&&0===i.current.getFeatures().length&&i.current.addFeatures(a)}),[i,a]);const O=Object(r.useCallback)((t=>{o(t&&t.selectedFeatureIndex)}),[]),p=Object(r.useCallback)((({editType:e})=>{"addFeature"===e&&(n(new u.EditingMode),i.current&&t(Object(b.setAreasAction)(i.current.getFeatures())))}),[t]),g=Object(r.useCallback)((async()=>{null!==c&&c>=0&&(await(i.current&&i.current.deleteFeatures(c)),i.current&&t(Object(b.setAreasAction)(i.current.getFeatures())))}),[c,t]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(u.Editor,{ref:i,style:{width:"100%",height:"100%"},clickRadius:12,mode:e,onSelect:O,onUpdate:p,editHandleShape:"circle",featureStyle:d,editHandleStyle:s,featuresDraggable:!0}),Object(f.jsxs)("div",{style:j,children:[e&&"DrawPolygonMode"!==e.constructor.name&&Object(f.jsx)("button",{onClick:()=>n(new u.DrawPolygonMode),children:"New poly"}),e&&"DrawPolygonMode"!==e.constructor.name&&null!==c&&Object(f.jsx)("button",{onClick:g,children:"Delete"})]})]})},p=n(14);var g=()=>{const t=Object(l.c)(p.getUserPathSourceSelector);return Object(f.jsx)(a.Source,{id:"my-data",type:"geojson",data:t,children:Object(f.jsx)(a.Layer,{id:"user-path-layer",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#01579b","line-width":6}})})};var h=t=>{const e=Object(l.b)();Object(r.useEffect)((()=>{const n=(()=>{return n=n=>{n&&(e(Object(p.pushPositionAction)(n)),t&&t(n))},navigator.geolocation.watchPosition((t=>{n(t)}),(t=>console.log(t)),{enableHighAccuracy:!0,maximumAge:5e3});var n})();return()=>{(t=>{navigator.geolocation.clearWatch(t)})(n)}}),[e,t])};n(140);var S=({viewport:{longitude:t,latitude:e,zoom:n}})=>Object(f.jsxs)("div",{className:"viewport-info",children:[Object(f.jsxs)("span",{className:"viewport-info__item",children:["longitude: ",t.toFixed(4)]}),Object(f.jsxs)("span",{className:"viewport-info__item",children:["latitude: ",e.toFixed(4)]}),Object(f.jsxs)("span",{className:"viewport-info__item",children:["zoom: ",n.toFixed(4)]})]}),E=n(21),v=n(50),A=n.n(v);n(141);var m=()=>{const t=Object(l.b)(),e=Object(l.c)(E.getModeSelector),n=Object(r.useCallback)((()=>t(Object(E.turnOnNavigateAction)())),[t]),c=Object(r.useCallback)((()=>t(Object(E.turnOnEditAction)())),[t]),o=Object(r.useCallback)((()=>t(Object(E.turnOnFreeAction)())),[t]);return Object(f.jsxs)("div",{className:"mode-bar",children:[Object(f.jsx)("button",{onClick:o,className:A()("mode-bar__button",{"mode-bar__button--active":"FREE"===e}),disabled:"FREE"===e,children:"Free mode"}),Object(f.jsx)("button",{onClick:n,className:A()("mode-bar__button",{"mode-bar__button--active":"NAVIGATE"===e}),disabled:"NAVIGATE"===e,children:"Navigate mode"}),Object(f.jsx)("button",{onClick:c,className:A()("mode-bar__button",{"mode-bar__button--active":"EDIT"===e}),disabled:"EDIT"===e,children:"Edit mode"})]})};n(142);var y=()=>{const t=Object(l.c)(p.getUserPositionSelector);return t&&Object(f.jsx)(a.Marker,{longitude:t.coords.longitude,latitude:t.coords.latitude,children:Object(f.jsx)("div",{className:"point"})})},x=n(51);var R=()=>{const t=Object(l.c)(b.getAreasSelector),e=Object(l.c)(p.getUserPositionSelector);return e?t.map((t=>{const n=t,r=x.polygon(n.geometry.coordinates),c=x.point([e.coords.longitude,e.coords.latitude]);return x.booleanContains(r,c)})):[]};var T=()=>{const t=Object(l.c)(b.getAreasSelector),e=R();return Object(f.jsx)(f.Fragment,{children:t.map(((t,n)=>Object(f.jsxs)(a.Source,{id:"feature"+n,type:"geojson",data:t,children:[Object(f.jsx)(a.Layer,{id:"feature"+n+"_layer",type:"fill",paint:{"fill-color":e[n]?"#ff867c":"#cfff95","fill-opacity":.6}}),Object(f.jsx)(a.Layer,{id:"feature"+n+"_layer_outline",type:"line",paint:{"line-color":e[n]?"#b61827":"#6b9b37","line-width":3}})]},n)))})};var N=()=>{const[t,e]=Object(r.useState)({longitude:-91.874,latitude:42.76,zoom:12}),n=Object(l.c)(E.getModeSelector),c=Object(l.c)(p.getUserPositionSelector);return Object(r.useEffect)((()=>{switch(n){case"FREE":return;case"NAVIGATE":return void(c&&e({longitude:c.coords.longitude,latitude:c.coords.latitude,zoom:16}))}}),[n,c,e]),h(),Object(f.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[Object(f.jsxs)(a.default,{...t,width:"100%",height:"100%",mapStyle:"mapbox://styles/kark-leo/ckrq5pa1k7b9j17qr2tvv7ixy",onViewportChange:e,mapboxApiAccessToken:"pk.eyJ1Ijoia2Fyay1sZW8iLCJhIjoiY2tycTVqeDF5MDRmaDJucHF6bjl0aWRlMSJ9.fVvoRu7-JIUyyIkbFQ9vQA",children:["NAVIGATE"!==n&&Object(f.jsx)(a.NavigationControl,{}),"EDIT"===n&&Object(f.jsx)(O,{}),Object(f.jsx)(g,{}),"EDIT"!==n&&Object(f.jsx)(T,{}),Object(f.jsx)(y,{})]}),Object(f.jsx)(S,{viewport:t}),Object(f.jsx)(m,{})]})};var _=function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(N,{})})};var D=t=>{t&&t instanceof Function&&n.e(3).then(n.bind(null,147)).then((({getCLS:e,getFID:n,getFCP:r,getLCP:c,getTTFB:o})=>{e(t),n(t),r(t),c(t),o(t)}))},P=(n(143),n(46));i.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(l.a,{store:P.appStore,children:Object(f.jsx)(_,{})})}),document.getElementById("root")),D()},18:function(t,e,n){"use strict";var r=n(73);n.o(r,"areasReducer")&&n.d(e,"areasReducer",(function(){return r.areasReducer})),n.o(r,"getAreasSelector")&&n.d(e,"getAreasSelector",(function(){return r.getAreasSelector})),n.o(r,"initialState")&&n.d(e,"initialState",(function(){return r.initialState})),n.o(r,"setAreasAction")&&n.d(e,"setAreasAction",(function(){return r.setAreasAction}));var c=n(74);n.d(e,"initialState",(function(){return c.a}));var o=n(42);n.d(e,"areasReducer",(function(){return o.b}));var i=n(75);n.d(e,"setAreasAction",(function(){return i.a}));var a=n(76);n.d(e,"getAreasSelector",(function(){return a.a}))},21:function(t,e,n){"use strict";var r=n(81);n.o(r,"getModeSelector")&&n.d(e,"getModeSelector",(function(){return r.getModeSelector})),n.o(r,"initialState")&&n.d(e,"initialState",(function(){return r.initialState})),n.o(r,"modeReducer")&&n.d(e,"modeReducer",(function(){return r.modeReducer})),n.o(r,"turnOnEditAction")&&n.d(e,"turnOnEditAction",(function(){return r.turnOnEditAction})),n.o(r,"turnOnFreeAction")&&n.d(e,"turnOnFreeAction",(function(){return r.turnOnFreeAction})),n.o(r,"turnOnNavigateAction")&&n.d(e,"turnOnNavigateAction",(function(){return r.turnOnNavigateAction}));var c=n(82);n.d(e,"initialState",(function(){return c.a}));var o=n(33);n.d(e,"modeReducer",(function(){return o.d}));var i=n(83);n.d(e,"turnOnEditAction",(function(){return i.a})),n.d(e,"turnOnFreeAction",(function(){return i.b})),n.d(e,"turnOnNavigateAction",(function(){return i.c}));var a=n(84);n.d(e,"getModeSelector",(function(){return a.a}))},33:function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return a}));var r=n(21);const c="MODE/TURN_ON_NAVIGATE",o="MODE/TURN_ON_EDIT",i="MODE/TURN_ON_FREE",a=(t=r.initialState,e)=>{switch(e.type){case c:return{...t,mode:"NAVIGATE"};case o:return{...t,mode:"EDIT"};case i:return{...t,mode:"FREE"};default:return t}}},42:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var r=n(18);const c="AREAS/SET_AREAS",o=(t=r.initialState,e)=>{switch(e.type){case c:return{...t,areas:e.areas};default:return t}}},43:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var r=n(14);const c="USER_PATH/PUSH__POSITION",o=(t=r.initialState,e)=>{switch(e.type){case c:return{...t,path:[...t.path,e.position],position:e.position};default:return t}}},46:function(t,e,n){"use strict";var r=n(85);n.d(e,"appReducer",(function(){return r.a}));var c=n(86);n.d(e,"appStore",(function(){return c.a}));n(87)},73:function(t,e){},74:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={areas:[]}},75:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(42);const c=t=>({type:r.a,areas:t})},76:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>t.areas.areas},77:function(t,e){},78:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={path:[],position:null}},79:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(43);const c=t=>({type:r.a,position:t})},80:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return o}));var r=n(91);const c=t=>t.userPath.position,o=Object(r.a)((t=>t.userPath.path),(t=>({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t.map((t=>[t.coords.longitude,t.coords.latitude]))}})))},81:function(t,e){},82:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={mode:"FREE"}},83:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(33);const c=()=>({type:r.a}),o=()=>({type:r.c}),i=()=>({type:r.b})},84:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r=t=>t.mode.mode},85:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(35),c=n(14),o=n(21),i=n(18);const a=Object(r.combineReducers)({userPath:c.userPathReducer,mode:o.modeReducer,areas:i.areasReducer})},86:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(35),c=n(92),o=n(46);const i=Object(r.createStore)(o.appReducer,Object(c.composeWithDevTools)())},87:function(t,e){},97:function(t,e,n){},98:function(t,e,n){}},[[145,1,2]]]);
//# sourceMappingURL=main.836f74aa.chunk.js.map